# ADR-001: Вибір бази даних для зберігання підписок

Created by: Назар Парносов
Status: Accepted
Created time: June 9, 2025 12:01 AM

## Контекст

Потрібно створити базу даних для сервісу надсилання на пошту погоди за підпискою. Зберігатись має:

- зберігання користувачів зі:
    - електронної пошти
    - Станом підписки:
        - Підписаний
        - Підтверджений
        - Відписаний
    - містом слідкуванням погоди
    - частоти надсилання
    - час останнього оновлення

## Розглянуті варіанти
### Порівняльна таблиця

| База даних | Надійність     | Паралельність      | Використання ресурсів | Складність налаштування | Розширюваність        |
| ---------- | -------------- | ------------------ | --------------------- | ----------------------- | --------------------- |
| PostgreSQL | Висока (ACID)  | Висока             | Середнє–високе        | Середня                 | Висока (реплікація)   |
| SQLite     | Середня (ACID) | Низька (локальний) | Низьке                | Дуже низька             | Низька (файлова БД)   |
| MongoDB    | Середня (BASE) | Висока             | Високе                | Середня                 | Дуже висока (шардінг) |


### Обраний варіант - **SQLite**

## Схема бази:

# Таблиця `subscriptions`

    | Тип       | Стовпець      | Обмеження                          |
    |-----------|---------------|------------------------------------|
    | INTEGER   | `id`          | INTEGER PRIMARY KEY                |
    | TEXT      | `email`       | NOT NULL                           |
    | TEXT      | `city`        | NOT NULL                           |
    | TEXT      | `token`       | NOT NULL                           |
    | INTEGER   | `confirmed`   | NOT NULL DEFAULT 0                 |
    | INTEGER   | `unsubscribed`| NOT NULL DEFAULT 0                 |
    | DATETIME  | `created_at`  | NOT NULL DEFAULT CURRENT_TIMESTAMP |
    | DATETIME  | `last_sent`   | DEFAULT NULL                       |
    | TEXT      | `frequency`   | NOT NULL DEFAULT 'hourly'          |

## Наслідки:

**Позитивні:**

    - “Zero-config” — нема потреби в окремому сервері або адмініструванні
    - Мінімальні архітектурні вимоги — усе в одному файлі
    - ACID‑підтримка достатня для невеликих обсягів даних.

**Негативні:**

    - Під час масштабних обсягів даних і великих транзакцій можлива деградація швидкості
    - Присутні лише основні типи даних
    - Запис лише однопотоковий
    - Відсутність контролю доступу



